let step=0;

cake.addEventListener("click", async e=>{
  e.stopPropagation();
  flames.forEach(f=>f.style.display="none");
  document.getElementById("cakeText").style.display="none";
  document.querySelector("#cakePage p").style.display="none";

  // animasi crumb & confetti
  for(let i=0;i<22;i++){
    const c=document.createElement("div");
    c.className="crumb";c.style.left="90px";c.style.top="55px";
    c.style.setProperty("--x",`${(Math.random()-0.5)*420}px`);
    c.style.setProperty("--y",`${(Math.random()-0.5)*320}px`);
    cake.appendChild(c);
  }
  cake.style.opacity="0";

  for(let i=0;i<80;i++){
    const conf=document.createElement("div");conf.className="confetti";
    conf.style.background=['#ff5f5f','#fce18a','#9cff5f','#5f9cff','#d05fff'][Math.floor(Math.random()*5)];
    conf.style.left=Math.random()*100+'vw';
    conf.style.width=5+Math.random()*8+'px';
    conf.style.height=5+Math.random()*8+'px';
    conf.style.animationDuration=(2+Math.random()*3)+'s';
    document.body.appendChild(conf);
    setTimeout(()=>conf.remove(),5000);
  }

  if(!started){
    started=true;
    music.volume=0;
    await music.play();
    let v=0;
    const fade=setInterval(()=>{v+=0.05;music.volume=v;if(v>=1)clearInterval(fade);},120);
  }

  slideshow.style.display="flex";
  photos[0].classList.add("active");

  // ======= PERUBAHAN: INTERVAL 15 DETIK =========
  setInterval(()=>{
    step++;
    photos.forEach(p=>p.classList.remove("active"));
    textSlides.forEach(t=>t.classList.remove("active"));

    // urutan slide: foto1 → foto2 → text → foto3 → foto4 → foto5 → text → ulang
    switch(step%8){
      case 0: photos[0].classList.add("active"); break; // foto1
      case 1: photos[1].classList.add("active"); break; // foto2
      case 2: textBox[0].textContent = ""; typeWriter(textBox[0], texts[0]); textSlides[0].classList.add("active"); break; // text1
      case 3: photos[2].classList.add("active"); break; // foto3
      case 4: photos[3].classList.add("active"); break; // foto4
      case 5: photos[4].classList.add("active"); break; // foto5
      case 6: textBox[1].textContent = ""; typeWriter(textBox[1], texts[1]); textSlides[1].classList.add("active"); break; // text2
      case 7: photos[0].classList.add("active"); break; // ulang loop
    }
  }, 15000); // 15000 ms = 15 detik
});
